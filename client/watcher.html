<!DOCTYPE html>
<html>
    <head>
        <script src="https://cdn.plyr.io/3.7.8/plyr.js"></script>
        <link rel="stylesheet" href="https://cdn.plyr.io/3.7.8/plyr.css" />
    </head>
    <body>
        <div id="wrapper">
            <video id="player" playsinline controls>
                <source src="http://127.0.0.1:8000/static/videos/video.mp4" type="video/mp4"></source>
            </video>
        </div>
    </body>

    <style>
        body {
        margin: 0;
        }
        .plyr {
        height: 100%;
        width :100%;
        }
        #wrapper{
        display: flex;
        justify-content:center;
        width: 50%;
        height: 500px;
        background-color: rgb(0, 0, 0);
        }
        .plyr__video-wrapper {
        height: 100%;
        }
        .plyr__video-wrapper iframe {
        width: 100%;
        height: 100%;
        }
    </style>
    <script>
        const player = new Plyr('#player', {
            listeners: {
                seek: function (e) {
                    e.preventDefault() // required on v2
                    // Your code here
                    return false    // required on v3
                }
            }
        });
        
        async function sync() {
            var response = await fetch("http://127.0.0.1:8000/",{
                method: "POST",
                headers: {'content-type': 'application/json'},
                body: JSON.stringify({"token":"abc"})
            })
            result = await response.json();
            if(response.status == 404)
            {
                console.log("Host doesnot exists")
            }
            else
            {
                if((result["hostTime"] - player.currentTime) > 1 || (result["hostTime"] - player.currentTime) < -1)
                {
                    player.currentTime = result["hostTime"];
                }
                if(result["paused"])
                {
                    player.pause();
                }
                if(result["playing"])
                {
                    player.play();
                }
                player.speed = result["speed"];
            }
            requestAnimationFrame(sync);
        }
        sync();
    </script>
</html>